#########################################################################################
## Versao 1.0.1 (20/01/2022) ############################################################
########################### Autores: ####################################################
## Augusto de Lelis Araujo - Federal University of Uberlandia (Uberlandia/MG - Brazil) ##
## e-mail: augusto-lelis@outlook.com                                                   ##
## =================================================================================== ##
## Renan Maciel da Paixao - Uppsala University (Uppsala/Sweden) #########################
## e-mail: renan.maciel@physics.uu.se                           #########################
#########################################################################################

#======================================================================
# Extraindo informações dos arquivos OUTCAR e CONTCAR =================
#======================================================================

#---------------------------------------------
exec(open("_VASProcar/informacoes.py").read())
#---------------------------------------------

#======================================================================
# Obtenção dos parâmetros de input por interação com usuário ==========
#======================================================================

if (leitura == 0):

   print ("##############################################################")
   print ("############### Plot da Estrutura de Bandas 3D ###############")
   print ("##############################################################")
   print (" ")
   print ("##############################################################") 
   print ("## Escolha a dimensao dos eixos-k no Plot 3D: ============= ##")
   print ("##############################################################")
   print ("## [1] (kx,ky,kz) em unidades de 2pi/Param. =============== ##")
   print ("## [2] (kx,ky,kz) em unidades de 1/Angs. ================== ##")
   print ("## [3] (kx,ky,kz) em unidades de 1/nm. ==================== ##")
   print ("## [4] (k1,k2,k3) Coord. Diretas: K = k1*B1 + k2*B2 + k3*B3 ##")   
   print ("##############################################################") 
   Dimensao = input (" "); Dimensao = int(Dimensao)
   print (" ")

   print ("##############################################################")
   print ("## Qual plano deve ser visualizado no Plot 3D? ============ ##")
   print ("##############################################################")
   print ("## [1] Plano (kx,ky) ou (k1,k2) =========================== ##")
   print ("## [2] Plano (kx,kz) ou (k1,k3) =========================== ##")
   print ("## [3] Plano (ky,kz) ou (k2,k3) =========================== ##")
   print ("##############################################################") 
   Plano_k = input (" "); Plano_k = int(Plano_k)
   print (" ")   

   print ("##############################################################")
   print ("Escolha as Bandas a serem Plotadas: ==========================")
   print ("##############################################################") 
   print ("Banda inicial: ===============================================")
   Band_i = input (" "); Band_i = int(Band_i)
   print (" ")
   print ("Banda final: =================================================")
   Band_f = input (" "); Band_f = int(Band_f)
   print (" ")

if (escolha == 6 or escolha == -6):
   print ("##############################################################")
   print ("## Como prefere que seja o Plot 3D? ======================= ##")
   print ("##############################################################")
   print ("## [0] Plotado em pontos (Plot mais leve) ================= ##")
   print ("## [1] Plotado superficies ================================ ##")
   print ("## [2] pontos + superficies =============================== ##")   
   print ("##############################################################") 
   tipo_plot = input (" "); tipo_plot = int(tipo_plot)
   print (" ")   

#======================================================================
# Obtenção dos parâmetros de input por leitura do arquivo de input ====
#======================================================================

# if (leitura == 1):
#    ??????????????????????????????????????????????????????????????????????
#    ??????????????????????????????????????????????????????????????????????
#    ??????????????????????????????????????????????????????????????????????

#----------------------------------------------------------------------
# Extraindo os resultados do(s) arquivo(s) PROCAR ---------------------
#----------------------------------------------------------------------

#---------------------------------------------
exec(open("_VASProcar/procar.py").read())
#--------------------------------------------

#----------------------------------------------------------------------
Band_antes   = (Band_i  - 1)       # Bandas que nao serao plotadas.
Band_depois  = (Band_f  + 1)       # Bandas que nao serao plotadas.
#----------------------------------------------------------------------

#======================================================================
# Gravando dados para o Plot 3D da Estrutura de Bandas ================
#======================================================================     

#-------------------------------------------
bandas_3D = open("saida/Bandas_3D.dat", "w")
#-------------------------------------------
    
for j in range (1,(n_procar+1)):
    for point_k in range (1,(nk+1)):
        if (Dimensao != 4):
           bandas_3D.write(f'{kx[j][point_k]} {ky[j][point_k]} {kz[j][point_k]} ')   
        if (Dimensao == 4):
           bandas_3D.write(f'{kb1[j][point_k]} {kb2[j][point_k]} {kb3[j][point_k]} ')
        for Band_n in range (Band_i,(Band_f+1)):
           bandas_3D.write(f'{Energia[j][point_k][Band_n]} ')
        bandas_3D.write("\n")
               
#----------------
bandas_3D.close()
#----------------

#------------------------------------------------
exec(open("_VASProcar/plot_bandas_3D.py").read())
#------------------------------------------------
   
############################################################################################################################################################################################
############################################################################################################################################################################################
#######
####### FIM DO CÓDIGO ######################################################################################################################################################################
#######
############################################################################################################################################################################################
############################################################################################################################################################################################
